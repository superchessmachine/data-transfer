import numpy as np
import matplotlib.pyplot as plt

# ── 1.  Time axis ────────────────────────────────────────────────────────────
# Use your real sampling times if they differ
time = np.array([0, 50, 100, 150, 200, 225, 250])  

# ── 2.  Raw fluorescence (3 technical replicates per sample) ────────────────
replicates = {
    "Sample X1": np.array([
        [705015, 722602, 745576, 768440, 790154, 806855, 827863],   # L-plate
        [555301, 573678, 597746, 620568, 644235, 667832, 688743],   # K-plate
        [916228, 932182, 949603, 968298, 986494, 999775, 1015950], # J-plate
    ]),
    "Sample X2": np.array([
        [339088, 352036, 366175, 381921, 395132, 408537, 422981],
        [326639, 341041, 356246, 369540, 380356, 396143, 407720],
        [524253, 539985, 554456, 573290, 588246, 601900, 617466],
    ]),
    "Sample X3": np.array([
        [389150, 399010, 409479, 422815, 431511, 440734, 452339],
        [300728, 314189, 329007, 343949, 357866, 372241, 385217],
        [405311, 418245, 435320, 449930, 467074, 482792, 495186],
    ]),
    "Sample X4": np.array([
        [266537, 275497, 285869, 295383, 303858, 315061, 327151],
        [246319, 254337, 265360, 273724, 281881, 290688, 300465],
        [341664, 353864, 366383, 380287, 394370, 403012, 417331],
    ]),
    "Sample X5": np.array([
        [134890, 136893, 140524, 145132, 147875, 152877, 155998],
        [132060, 136099, 139725, 143216, 147785, 151983, 156454],
        [169522, 174497, 178387, 184107, 188451, 192175, 198325],
    ]),
    "Sample X6": np.array([
        [202905, 207973, 209058, 213030, 217334, 222070, 225795],
        [197359, 199577, 202573, 205628, 209209, 212650, 218096],
        [246568, 251332, 253090, 260111, 262909, 268434, 273032],
    ]),
    "Sample X7": np.array([
        [114263, 114078, 116953, 116821, 117766, 119311, 120459],
        [120895, 121538, 122725, 124298, 125542, 127555, 127053],
        [129589, 130305, 131574, 132809, 133900, 134124, 135674],
    ]),
    "Sample X8": np.array([
        [ 83070,  82961,  83492,  83854,  84107,  84700,  84754],
        [ 90047,  88675,  89723,  90535,  90305,  90024,  90636],
        [ 99568,  99166, 100322, 100482, 100421, 100517, 101614],
    ]),
    "Sample X9": np.array([
        [121532, 122519, 121461, 121332, 120632, 120562, 121473],
        [128818, 127314, 128044, 127000, 127351, 127998, 127210],
        [177887, 181385, 187411, 193535, 199928, 203711, 209629],
    ]),
    "Sample X10": np.array([
        [ 93480,  92734,  92816,  92628,  92287,  91850,  92137],
        [ 84637,  84317,  84980,  84613,  84018,  84858,  85219],
        [108788, 110732, 113045, 114061, 116712, 118976, 120524],
    ]),
    "Sample X11": np.array([
        [ 95998,  96277,  96122,  94610,  95197,  95121,  95062],
        [ 91238,  91691,  91922,  91486,  92685,  92181,  92142],
        [105903, 106198, 107478, 107649, 108218, 109657, 110341],
    ]),
    "Sample X12": np.array([
        [101309, 101055, 100577,  99575,  99120,  98699,  99074],
        [ 91649,  91453,  91700,  90925,  91318,  91726,  91303],
        [101958, 101969, 101708, 101236, 101902, 102332, 102420],
    ]),
}

# ── 3.  Plot ────────────────────────────────────────────────────────────────
plt.figure(figsize=(12, 6))

color_cycle = plt.cm.get_cmap("tab10", len(replicates))

for i, (label, arr) in enumerate(replicates.items()):
    mean = arr.mean(axis=0)
    std  = arr.std(axis=0)
    plt.errorbar(
        time,
        mean,
        yerr=std,
        label=label,
        marker="o",
        capsize=3,
        linewidth=2,
        markersize=5,
        color=color_cycle(i),
    )

plt.title("Raw Fluorescence Signal across Samples")
plt.xlabel("Time (s)")
plt.ylabel("Fluorescence Units")
plt.legend(title="Sample", bbox_to_anchor=(1.04, 1), loc="upper left")
plt.tight_layout()
plt.show()